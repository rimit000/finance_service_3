<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoJSON 기반 대륙별 클릭 가능한 세계지도</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            text-align: center;
            padding: 40px;
            background: linear-gradient(45deg, #2196F3, #21CBF3);
            color: white;
        }
        
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.8em;
            font-weight: 300;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .map-container {
            position: relative;
            padding: 40px;
            text-align: center;
            background: #f8f9fa;
        }
        
        .world-map {
            width: 100%;
            max-width: 1000px;
            height: auto;
            background: #e3f2fd;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .continent {
            transition: all 0.3s ease;
            cursor: pointer;
            stroke: #ffffff;
            stroke-width: 1;
        }
        
        .continent:hover {
            filter: brightness(1.1) drop-shadow(0 0 10px rgba(0,0,0,0.3));
            stroke-width: 2;
        }

        .continent.selected {
            filter: brightness(1.2) drop-shadow(0 0 15px rgba(0,0,0,0.4));
            stroke-width: 3;
            stroke: #ff6b6b;
        }
        
        /* 대륙별 색상 */
        .antarctica { fill: #74B9FF; }
        .asia { fill: #FECA57; }
        .south-america { fill: #4ECDC4; }
        .north-america { fill: #FF6B6B; }
        .europe { fill: #45B7D1; }
        .oceania { fill: #FF9FF3; }
        .africa { fill: #96CEB4; }
        
        .info-panel {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border-radius: 15px;
            min-height: 200px;
            transition: all 0.5s ease;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .continent-info {
            display: none;
        }
        
        .continent-info.active {
            display: block;
            animation: fadeInUp 0.6s ease;
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .continent-title {
            font-size: 2.2em;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: center;
        }
        
        .continent-details {
            font-size: 1.1em;
            line-height: 1.8;
            color: #555;
            text-align: left;
        }

        .continent-details strong {
            color: #2c3e50;
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
            padding: 0 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background: white;
            border-radius: 25px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .legend-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 25px rgba(0,0,0,0.15);
            border-color: #ddd;
        }

        .legend-item.selected {
            border-color: #ff6b6b;
            background: #fff5f5;
        }
        
        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.8);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .legend-text {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .default-info {
            text-align: center;
            color: #7f8c8d;
            font-size: 1.3em;
            padding: 60px 40px;
            font-style: italic;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c3e50;
            display: block;
        }

        .stat-label {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 5px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 1.2em;
        }

        .error {
            text-align: center;
            padding: 40px;
            color: #e74c3c;
            font-size: 1.1em;
            background: #ffeaa7;
            border-radius: 10px;
            margin: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌍 Interactive World Map</h1>
            <p>Flask + GeoJSON 기반 대륙별 세계지도</p>
        </div>
        
        <div class="map-container">
            <div class="loading" id="loading">
                <div class="spinner"></div>
                지도 데이터를 불러오는 중...
            </div>
            <svg class="world-map" id="worldMap" style="display: none;" viewBox="-180 -90 360 180" xmlns="http://www.w3.org/2000/svg">
                <!-- 대륙들이 여기에 동적으로 추가됩니다 -->
            </svg>
            
            <div class="legend" id="legend" style="display: none;">
                <!-- 범례가 동적으로 생성됩니다 -->
            </div>
        </div>
        
        <div class="info-panel">
            <div class="default-info">
                대륙을 클릭하거나 범례를 선택하여 상세 정보를 확인하세요
            </div>
            
            <div class="continent-info" id="antarctica">
                <div class="continent-title">🐧 남극 대륙 (Antarctica)</div>
                <div class="continent-details">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">1,400만</span>
                            <span class="stat-label">면적 (km²)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">1,000-5,000</span>
                            <span class="stat-label">연구진 수 (계절별)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">-89°C</span>
                            <span class="stat-label">최저 기온</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">98%</span>
                            <span class="stat-label">얼음 덮인 비율</span>
                        </div>
                    </div>
                    <br>
                    <strong>특징:</strong> 지구에서 가장 춥고 건조한 대륙으로, 전 세계 담수의 약 70%가 얼음 형태로 저장되어 있습니다. 
                    과학 연구의 중요한 거점이며, 남극 조약에 의해 평화적 목적으로만 사용되고 있습니다.
                    <br><br>
                    <strong>주요 연구 기지:</strong> 맥머도 기지(미국), 로테라 기지(아르헨티나), 세종과학기지(한국) 등
                </div>
            </div>
            
            <div class="continent-info" id="asia">
                <div class="continent-title">🏔️ 아시아 (Asia)</div>
                <div class="continent-details">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">4,460만</span>
                            <span class="stat-label">면적 (km²)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">46억</span>
                            <span class="stat-label">인구</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">48개</span>
                            <span class="stat-label">국가 수</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">60%</span>
                            <span class="stat-label">세계 인구 비율</span>
                        </div>
                    </div>
                    <br>
                    <strong>주요 국가:</strong> 중국, 인도, 일본, 한국, 인도네시아, 러시아 등
                    <br><br>
                    <strong>특징:</strong> 세계에서 가장 크고 인구가 많은 대륙으로, 급속한 경제 발전과 기술 혁신을 이루고 있습니다. 
                    다양한 문화와 종교가 공존하며, 세계 경제의 중심지로 부상하고 있습니다.
                    <br><br>
                    <strong>주요 특징:</strong> 히말라야 산맥, 실크로드, K-pop과 한류, 제조업 허브
                </div>
            </div>
            
            <div class="continent-info" id="south-america">
                <div class="continent-title">🌴 남미 (South America)</div>
                <div class="continent-details">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">1,780만</span>
                            <span class="stat-label">면적 (km²)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">4억 3천만</span>
                            <span class="stat-label">인구</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">12개</span>
                            <span class="stat-label">국가 수</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">60%</span>
                            <span class="stat-label">아마존이 차지하는 비율</span>
                        </div>
                    </div>
                    <br>
                    <strong>주요 국가:</strong> 브라질, 아르헨티나, 콜롬비아, 페루, 칠레 등
                    <br><br>
                    <strong>특징:</strong> 아마존 열대우림과 안데스 산맥으로 유명한 생물 다양성의 보고입니다. 
                    풍부한 천연자원과 독특한 문화를 가지고 있으며, 축구와 삼바, 탱고 등의 문화로도 유명합니다.
                    <br><br>
                    <strong>자연 유산:</strong> 아마존 우림, 갈라파고스 제도, 이과수 폭포, 마추픽추
                </div>
            </div>
            
            <div class="continent-info" id="north-america">
                <div class="continent-title">🍁 북미 (North America)</div>
                <div class="continent-details">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">2,470만</span>
                            <span class="stat-label">면적 (km²)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">5억 8천만</span>
                            <span class="stat-label">인구</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">23개</span>
                            <span class="stat-label">국가 수</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">25%</span>
                            <span class="stat-label">세계 GDP 비율</span>
                        </div>
                    </div>
                    <br>
                    <strong>주요 국가:</strong> 미국, 캐나다, 멕시코, 과테말라 등
                    <br><br>
                    <strong>특징:</strong> 세계 최대 경제 규모를 자랑하며, 기술 혁신과 문화 산업의 중심지입니다. 
                    다양한 기후와 지형을 가지고 있으며, 이민자들로 구성된 다문화 사회를 형성하고 있습니다.
                    <br><br>
                    <strong>주요 도시:</strong> 뉴욕, 로스앤젤레스, 토론토, 멕시코시티
                </div>
            </div>
            
            <div class="continent-info" id="europe">
                <div class="continent-title">🏰 유럽 (Europe)</div>
                <div class="continent-details">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">1,020만</span>
                            <span class="stat-label">면적 (km²)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">7억 5천만</span>
                            <span class="stat-label">인구</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">50개</span>
                            <span class="stat-label">국가 수</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">27개</span>
                            <span class="stat-label">EU 회원국</span>
                        </div>
                    </div>
                    <br>
                    <strong>주요 국가:</strong> 독일, 프랑스, 영국, 이탈리아, 스페인, 러시아 등
                    <br><br>
                    <strong>특징:</strong> 풍부한 역사와 문화유산을 가진 대륙으로 현대 문명의 발상지입니다. 
                    르네상스, 계몽주의, 산업혁명 등 인류 역사의 중요한 전환점들이 일어난 곳입니다.
                    <br><br>
                    <strong>문화유산:</strong> 콜로세움, 에펠탑, 파르테논 신전, 베르사유 궁전
                </div>
            </div>
            
            <div class="continent-info" id="oceania">
                <div class="continent-title">🦘 오세아니아 (Oceania)</div>
                <div class="continent-details">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">850만</span>
                            <span class="stat-label">면적 (km²)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">4,500만</span>
                            <span class="stat-label">인구</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">14개</span>
                            <span class="stat-label">국가 수</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">10,000+</span>
                            <span class="stat-label">섬의 개수</span>
                        </div>
                    </div>
                    <br>
                    <strong>주요 국가:</strong> 호주, 뉴질랜드, 파푸아뉴기니, 피지, 통가 등
                    <br><br>
                    <strong>특징:</strong> 독특한 생태계와 아름다운 자연경관으로 유명한 대륙입니다. 
                    고립된 지리적 위치로 인해 캥거루, 코알라 등 특별한 동물들이 서식하고 있습니다.
                    <br><br>
                    <strong>자연 명소:</strong> 그레이트 배리어 리프, 울루루, 밀포드 사운드
                </div>
            </div>
            
            <div class="continent-info" id="africa">
                <div class="continent-title">🦁 아프리카 (Africa)</div>
                <div class="continent-details">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value">3,020만</span>
                            <span class="stat-label">면적 (km²)</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">13억</span>
                            <span class="stat-label">인구</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">54개</span>
                            <span class="stat-label">국가 수</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">2,000+</span>
                            <span class="stat-label">언어 수</span>
                        </div>
                    </div>
                    <br>
                    <strong>주요 국가:</strong> 나이지리아, 이집트, 남아프리카공화국, 케냐, 에티오피아 등
                    <br><br>
                    <strong>특징:</strong> 인류의 발상지이며 세계에서 두 번째로 큰 대륙입니다. 
                    풍부한 천연자원과 다양한 문화, 그리고 놀라운 야생동물로 유명합니다.
                    <br><br>
                    <strong>자연 유산:</strong> 사하라 사막, 나일강, 킬리만자로, 세렝게티 국립공원
                </div>
            </div>
        </div>
    </div>

    <script>
        // 대륙별 색상 매핑
        const continentColors = {
            'antarctica': '#74B9FF',
            'asia': '#FECA57',
            'south-america': '#4ECDC4',
            'north-america': '#FF6B6B',
            'europe': '#45B7D1',
            'oceania': '#FF9FF3',
            'africa': '#96CEB4'
        };

        // 대륙별 한국어 이름
        const continentNames = {
            'antarctica': '남극 대륙',
            'asia': '아시아',
            'south-america': '남미',
            'north-america': '북미',
            'europe': '유럽',
            'oceania': '오세아니아',
            'africa': '아프리카'
        };

        let selectedContinent = null;

        // GeoJSON 파일 읽기 및 지도 생성
        async function loadMap() {
            try {
                console.log('지도 데이터 로딩 시작...');
                
                // Fetch API를 사용하여 Flask 서버에서 GeoJSON 파일 가져오기
                const response = await fetch('/data/continent-low.geo.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const geoData = await response.json();
                console.log('GeoJSON 데이터 로드 완료:', geoData);
                
                // 지도 생성
                createMap(geoData);
                
                // 로딩 숨기고 지도 표시
                document.getElementById('loading').style.display = 'none';
                document.getElementById('worldMap').style.display = 'block';
                document.getElementById('legend').style.display = 'grid';
                
                console.log('지도 생성 완료!');
                
            } catch (error) {
                console.error('파일을 읽는 중 오류 발생:', error);
                document.getElementById('loading').innerHTML = `
                    <div class="error">
                        ⚠️ 지도 데이터를 불러올 수 없습니다.<br>
                        오류: ${error.message}<br>
                        <small>GeoJSON 파일이 올바른 위치(/data/continent-low.geo.json)에 있는지 확인해주세요.</small>
                    </div>
                `;
            }
        }

        // 좌표를 SVG path로 변환하는 함수
        function coordinatesToPath(coordinates) {
            let path = '';
            
            if (coordinates[0] && Array.isArray(coordinates[0][0])) {
                // MultiPolygon 처리
                coordinates.forEach(polygon => {
                    polygon.forEach((ring, ringIndex) => {
                        ring.forEach((coord, index) => {
                            const [lng, lat] = coord;
                            const command = index === 0 ? 'M' : 'L';
                            path += `${command}${lng},${-lat} `;
                        });
                        path += 'Z ';
                    });
                });
            } else {
                // Polygon 처리
                coordinates.forEach((ring, ringIndex) => {
                    ring.forEach((coord, index) => {
                        const [lng, lat] = coord;
                        const command = index === 0 ? 'M' : 'L';
                        path += `${command}${lng},${-lat} `;
                    });
                    path += 'Z ';
                });
            }
            
            return path.trim();
        }

        // 지도 생성 함수
        function createMap(geoData) {
            console.log('지도 생성 함수 실행...');
            const svg = document.getElementById('worldMap');
            const legendContainer = document.getElementById('legend');
            
            // 각 대륙에 대해 처리
            geoData.features.forEach((feature, index) => {
                console.log(`대륙 ${index + 1} 처리 중:`, feature.properties);
                
                const continentId = feature.properties.id;
                const continentName = continentNames[continentId] || feature.properties['en-name'];
                const color = continentColors[continentId] || '#ccc';
                
                // SVG path 요소 생성
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', coordinatesToPath(feature.geometry.coordinates));
                path.setAttribute('class', `continent ${continentId}`);
                path.setAttribute('data-continent', continentId);
                path.style.fill = color;
                
                // 클릭 이벤트 추가
                path.addEventListener('click', () => selectContinent(continentId));
                
                svg.appendChild(path);
                
                // 범례 아이템 생성
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.setAttribute('data-continent', continentId);
                legendItem.innerHTML = `
                    <div class="legend-color" style="background-color: ${color};"></div>
                    <span class="legend-text">${continentName}</span>
                `;
                
                // 범례 클릭 이벤트 추가
                legendItem.addEventListener('click', () => selectContinent(continentId));
                
                legendContainer.appendChild(legendItem);
            });
            
            console.log('모든 대륙 생성 완료!');
        }

        // 대륙 선택 함수
        function selectContinent(continentId) {
            console.log('대륙 선택:', continentId);
            
            // 이전 선택 해제
            document.querySelectorAll('.continent.selected').forEach(el => {
                el.classList.remove('selected');
            });
            document.querySelectorAll('.legend-item.selected').forEach(el => {
                el.classList.remove('selected');
            });
            document.querySelectorAll('.continent-info.active').forEach(el => {
                el.classList.remove('active');
            });
            
            // 기본 정보 숨기기
            document.querySelector('.default-info').style.display = 'none';
            
            // 새로운 선택 적용
            const continentElement = document.querySelector(`[data-continent="${continentId}"].continent`);
            const legendElement = document.querySelector(`[data-continent="${continentId}"].legend-item`);
            const infoElement = document.getElementById(continentId);
            
            if (continentElement) continentElement.classList.add('selected');
            if (legendElement) legendElement.classList.add('selected');
            if (infoElement) infoElement.classList.add('active');
            
            selectedContinent = continentId;
            
            // 선택된 대륙으로 부드럽게 스크롤
            if (infoElement) {
                infoElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // 페이지 로드 시 지도 로드
        document.addEventListener('DOMContentLoaded', function() {
            console.log('페이지 로드 완료, 지도 로딩 시작...');
            loadMap();
        });
    </script>
</body>
</html>